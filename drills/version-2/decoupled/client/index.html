<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <header>
      <h1>galvanize</h1>
    </header>
    <main>
      <section>
        <h2>Pay Your Bill</h2>
      </section>
        <!-- Add payment form here -->
        <form class='StripeElement' action="/charge" method="post" id="payment-form">
          <div class="form-row">
            <label for="card-element">
              Credit or debit card
            </label>
            <div id="card-element">
              <!-- A Stripe Element will be inserted here. -->
            </div>
          
            <!-- Used to display Element errors. -->
            <div id="card-errors" role="alert"></div>
          </div>
        
          <button>Submit Payment</button>
        </form>
    </main>
    <!-- Add stripe client side library here -->
    <script src="https://js.stripe.com/v3/"></script>
    <script>
        const stripe = Stripe('pk_test_K23BCqS1ExD17Jr4blcPGq1t')
        const elements = stripe.elements()
        
        var style = {
                base: {
                  color: '#32325d',
                  lineHeight: '18px',
                  fontFamily: '"Helvetica Neue", Helvetica, sans-serif',
                  fontSmoothing: 'antialiased',
                  fontSize: '16px',
                  '::placeholder': {
                    color: '#aab7c4'
                  }
                },
                invalid: {
                  color: '#fa755a',
                  iconColor: '#fa755a'
            }
        }
        const card = elements.create('card', {style: style})

        card.mount('#card-element')

        card.addEventListener('change', function(event) {
            let displayError = document.getElementById('card-errors')
            if (event.error) {
              displayError.textContent = event.error.message
            } else {
              displayError.textContent = ''
            }
        })

        var form = document.getElementById('payment-form')
            form.addEventListener('submit', function(event) {
                event.preventDefault()

        stripe.createToken(card).then(function(result) {
            if (result.error) {
            // Inform the user if there was an error.
                var errorElement = document.getElementById('card-errors')
                errorElement.textContent = result.error.message
            } else {
                // Send the token to your server.
                stripeTokenHandler(result.token)
                }
            })
        })

    </script>
  </body>
</html>